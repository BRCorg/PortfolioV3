<div class="project-detail-page">
    <a href="/#projects" class="back-to-portfolio">
        <i class="fas fa-arrow-left"></i>
        <span>Retour aux projets</span>
    </a>

    <div class="project-detail-container">
        <div class="project-detail-intro">
            <h1 class="project-detail-title"><?= htmlspecialchars($project['title']) ?></h1>
            <?php if (!empty($project['skills'])): ?>
                <div class="project-skills-icons">
                    <?php
                    $iconMap = [
                        'html' => 'devicon-html5-plain colored', 'html5' => 'devicon-html5-plain colored',
                        'css' => 'devicon-css3-plain colored', 'css3' => 'devicon-css3-plain colored',
                        'sass' => 'devicon-sass-original colored', 'scss' => 'devicon-sass-original colored',
                        'javascript' => 'devicon-javascript-plain colored', 'js' => 'devicon-javascript-plain colored',
                        'typescript' => 'devicon-typescript-plain colored', 'ts' => 'devicon-typescript-plain colored',
                        'react' => 'devicon-react-original colored', 'reactjs' => 'devicon-react-original colored',
                        'php' => 'devicon-php-plain colored',
                        'symfony' => 'devicon-symfony-original colored',
                        'node.js' => 'devicon-nodejs-plain colored', 'nodejs' => 'devicon-nodejs-plain colored',
                        'wordpress' => 'devicon-wordpress-plain colored',
                        'figma' => 'devicon-figma-plain colored',
                        'docker' => 'devicon-docker-plain colored',
                        'github' => 'devicon-github-original', 'git' => 'devicon-git-plain colored',
                        'mysql' => 'devicon-mysql-plain colored',
                        'postgresql' => 'devicon-postgresql-plain colored',
                        'mongodb' => 'devicon-mongodb-plain colored'
                    ];

                    foreach ($project['skills'] as $skill):
                        $skillKey = strtolower(trim($skill['name']));
                        $iconClass = !empty($skill['icon_class']) ? $skill['icon_class'] : ($iconMap[$skillKey] ?? null);
                    ?>
                        <?php if ($iconClass): ?>
                            <i class="<?= htmlspecialchars($iconClass) ?>" title="<?= htmlspecialchars($skill['name']) ?>"></i>
                        <?php endif; ?>
                    <?php endforeach; ?>
                </div>
            <?php endif; ?>
        </div>

        <?php if (!empty($project['images'])): ?>
            <?php if (count($project['images']) > 1): ?>
                <div class="project-detail-carousel swiper">
                    <div class="swiper-wrapper">
                        <?php foreach ($project['images'] as $image): ?>
                            <div class="swiper-slide">
                                <img src="<?= htmlspecialchars($image['file_path']) ?>"
                                     alt="<?= htmlspecialchars($image['alt_text'] ?? $project['title']) ?>"
                                     loading="lazy">
                            </div>
                        <?php endforeach; ?>
                    </div>
                    <div class="swiper-button-prev"></div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-pagination"></div>
                </div>
            <?php else: ?>
                <div class="project-detail-single-image">
                    <img src="<?= htmlspecialchars($project['images'][0]['file_path']) ?>"
                         alt="<?= htmlspecialchars($project['title']) ?>"
                         loading="lazy">
                </div>
            <?php endif; ?>
        <?php elseif (!empty($project['image'])): ?>
            <div class="project-detail-single-image">
                <img src="<?= htmlspecialchars($project['image']) ?>"
                     alt="<?= htmlspecialchars($project['title']) ?>"
                     loading="lazy">
            </div>
        <?php endif; ?>

        <?php if (!empty($project['long_description'])): ?>
            <div class="project-detail-description">
                <h2><i class="fas fa-info-circle"></i> Description du projet</h2>
                <div class="description-content">
                    <?= nl2br(htmlspecialchars($project['long_description'])) ?>
                </div>
            </div>
        <?php elseif (!empty($project['description'])): ?>
            <div class="project-detail-description">
                <h2><i class="fas fa-info-circle"></i> Description du projet</h2>
                <div class="description-content">
                    <?= nl2br(htmlspecialchars($project['description'])) ?>
                </div>
            </div>
        <?php endif; ?>
    </div>
</div>
